<% name = (player.respond_to?(:full_name) && player.full_name.present?) ? player.full_name : "#{player.first_name} #{player.last_name}" %>
<% abbr = player.team_abbreviation.to_s.upcase %>
<% logo = team_logo_path(abbr) %>

<div class="overflow-hidden rounded-3xl border border-slate-900/10 bg-white/65 shadow-sm backdrop-blur">
  <!-- Top bar / header -->
  <div class="flex flex-col gap-4 p-6 sm:flex-row sm:items-center sm:justify-between">
    <div class="flex items-center gap-4">
      <% if logo.present? %>
        <%= image_tag logo,
          alt: "#{abbr} logo",
          class: "h-16 w-16 flex-none rounded-2xl border border-slate-900/10 bg-slate-900/5 p-2 object-contain"
        %>
      <% else %>
        <div class="flex h-16 w-16 flex-none items-center justify-center rounded-2xl border border-slate-900/10 bg-slate-900/5 text-sm font-black tracking-wide text-slate-800">
          <%= abbr.presence || "N/A" %>
        </div>
      <% end %>

      <div class="min-w-0">
        <div class="text-3xl font-extrabold tracking-tight text-slate-900">
          <%= name %>
        </div>

        <div class="mt-2 flex flex-wrap items-center gap-2">
          <span class="inline-flex items-center rounded-full border border-slate-900/10 bg-slate-900/5 px-3 py-1 text-xs font-extrabold tracking-wide text-slate-800">
            <%= abbr.presence || "No team" %>
          </span>

          <%# Optional: if you pass a team name like @team[:name] or @team.name %>
          <% if defined?(team) && team.present? %>
            <span class="text-sm font-semibold text-slate-700">
              <%= team.respond_to?(:name) ? team.name : (team[:name] rescue nil) %>
            </span>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Right side "season tag" -->
    <div class="flex items-center gap-2">
      <span class="inline-flex items-center rounded-2xl border border-slate-900/10 bg-white/70 px-4 py-2 text-sm font-extrabold text-slate-900">
        2025â€“26
      </span>
    </div>
  </div>

  <!-- Divider -->
  <div class="h-px bg-slate-900/10"></div>

  <!-- Stats section -->
  <div class="p-6">
    <div class="flex items-end justify-between gap-4">
      <div>
        <div class="text-lg font-extrabold tracking-tight text-slate-900">Season Stats</div>
        <div class="mt-1 text-sm font-semibold text-slate-700">
          Per game â€¢ Regular season
        </div>
      </div>
      <%# Optional slot for a â€œHotâ€ / â€œGemâ€ badge later %>
      <%# <span class="rounded-full bg-orange-500 px-3 py-1 text-xs font-black text-black">ðŸ”¥ HOT</span> %>
    </div>

    <% if stats.present? %>
      <div class="mt-5 grid grid-cols-2 gap-3 sm:grid-cols-4">
        <%= render "stat_tile", 
          label: "PTS", 
          value: stats&.games_played.to_i > 0 ? (stats.pts.to_f / stats.games_played).round(1) : "â€”"
        %>
        <%= render "stat_tile", 
          label: "REB", 
          value: stats&.games_played.to_i > 0 ? (stats.reb.to_f / stats.games_played).round(1) : "â€”"
        %>
        <%= render "stat_tile", 
          label: "AST", 
          value: stats&.games_played.to_i > 0 ? (stats.ast.to_f / stats.games_played).round(1) : "â€”"
        %>
        <%= render "stat_tile", 
          label: "STL", 
          value: stats&.games_played.to_i > 0 ? (stats.stl.to_f / stats.games_played).round(1) : "â€”"
        %>
        <%= render "stat_tile", 
          label: "BLK", 
          value: stats&.games_played.to_i > 0 ? (stats.blk.to_f / stats.games_played).round(1) : "â€”"
        %>
        <%= render "stat_tile", 
          label: "TOV", 
          value: stats&.games_played.to_i > 0 ? (stats.tov.to_f / stats.games_played).round(1) : "â€”"
        %>

        <%= render "stat_tile", label: "FG%", value: stats&.fg_pct || "â€”" %>
        <%= render "stat_tile", label: "3P%", value: stats&.fg3_pct || "â€”" %>
        <%= render "stat_tile", label: "FT%", value: stats&.ft_pct || "â€”" %>
        <%= render "stat_tile", label: "MIN", value: stats&.total_minutes || "â€”" %>
      </div>
    <% else %>
      <div class="mt-5 rounded-2xl border border-slate-900/10 bg-white/70 p-4 text-sm font-semibold text-slate-700">
        Stats not loaded yet â€” hook your 2025â€“26 endpoint into <span class="font-extrabold text-slate-900">@stats</span> and this box will fill automatically.
      </div>
    <% end %>
  </div>
</div>
